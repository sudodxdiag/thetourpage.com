YUI.add("photo-stats-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getInfo"].run(e,this.appContext)},update:function(e,a){var n={photoId:e},r=!0;return a.datePostedPartial?(n.datePostedPartial=a.datePostedPartial.newVal,r=!1):a.datePosted&&(n.datePosted=a.datePosted.newVal,r=!1),a.dateTakenPartial?(n.dateTakenPartial=a.dateTakenPartial.newVal,r=!1):a.dateTaken&&(n.dateTaken=a.dateTaken.newVal,r=!1),a.takenGranularity&&(n.takenGranularity=a.takenGranularity.newVal,r=!1),r?t.Promise.resolve():t.ModelUpdaters["flickr-photos-setDates"].run(n,this.appContext)},batchUpdate:function(e,a){var n={photoId:e,fullResponse:1};return"datePostedPartial"in a&&"dateTakenPartial"in a?(n.datePostedPartial=a.datePostedPartial,n.dateTakenPartial=a.dateTakenPartial,n.takenGranularity=a.takenGranularity):"datePostedPartial"in a?n.datePostedPartial=a.datePostedPartial:"dateTakenPartial"in a?(n.dateTakenPartial=a.dateTakenPartial,n.takenGranularity=a.takenGranularity):"postedDate"in a&&"takenDate"in a?(n.datePosted=a.postedDate,n.dateTaken=a.takenDate,n.takenGranularity=a.takenGranularity):"postedDate"in a?n.datePosted=a.postedDate:(n.dateTaken=a.takenDate,n.takenGranularity=a.takenGranularity),t.ModelUpdaters["flickr-photos-setDates"].run(n,this.appContext)}},attributes:{dateTaken:{},dateTakenPartial:{},datePosted:{},datePostedPartial:{},takenGranularity:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return((e=t.AttributeHelpers.coerceInteger(e))<0||e>10)&&(e=void 0),e},defaultValue:0},isDateTakenUnknown:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return e=t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isCirca:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(t){return 8===this.getValue(t,"takenGranularity")}},isSometime:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(t){return 6===this.getValue(t,"takenGranularity")}},datePostedWithTimezone:{readOnly:!0,derivedBy:["datePosted"],defaultFn:function(e){var a=this.getValue(e,"datePosted"),n=this.appContext.getViewer().prefs.timezonePref,r=t.moment(a,"X");return n.name&&r.tz(n.name),r}}},getDateObj:function(e,a){if("dateTaken"!==a&&"datePosted"!==a)throw new Error(this.intlMessage({intlName:"models.BAD_DATE_TYPE"}));var n={},r=this.getValue(e,a),o=this.getValue(e,"takenGranularity"),i=this.appContext.getViewer().prefs.timezonePref;return r?("dateTaken"===a?n=8===o?{granularity:o,year:r.replace(/^([\d]+)(.*)/g,"$1"),monthName:this.intlMessage({intlName:"common.CIRCA"})}:6===o?{granularity:o,year:(r=t.moment(r)).format("YYYY"),monthName:this.intlMessage({intlName:"common.SOMETIME_IN"})}:4===o?{granularity:o,year:(r=t.moment(r)).format("YYYY"),month:r.format("M"),monthName:r.format("MMMM")}:{granularity:o,year:(r=t.moment(r)).format("YYYY"),month:r.format("M"),monthName:r.format("MMMM"),day:r.format("D"),hour:r.format("HH"),minute:r.format("mm"),second:r.format("ss")}:(r=t.moment(r,"X"),i.name&&r.tz(i.name),n={granularity:o,year:r.format("YYYY"),month:r.format("M"),monthName:r.format("MMMM"),day:r.format("D"),hour:r.format("HH"),minute:r.format("mm"),second:r.format("ss")},i.isDefaults||(n.tzOffset=i.offset)),n):{}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-setDates-updater","moment","moment-timezone"],langBundles:["models","common"]});YUI.add("hermes-lang-models",(function(e,t){e.Intl.add("hermes/models","en-US",{YOUR_PHOTOSTREAM:[{type:0,value:"Your photostream"}],USER_PHOTOSTREAM:[{type:1,value:"name"},{type:0,value:"’s photostream"}],USER_PHOTOS:[{type:1,value:"name"},{type:0,value:"’s photos"}],PHOTOSTREAM:[{type:0,value:"Photostream"}],YOUR_FAVORITES:[{type:0,value:"Your favorites"}],USER_FAVORITES:[{type:1,value:"name"},{type:0,value:"’s favorites"}],FAVORITES:[{type:0,value:"Favorites"}],ZERO_PHOTOS:[{type:0,value:"0 photos"}],ONE_PHOTO:[{type:0,value:"1 photo"}],MULTIPLE_PHOTOS:[{type:1,value:"photos"},{type:0,value:" photos"}],PLURAL_PHOTOS:[{type:6,value:"count",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"}],ONE_VIDEO:[{type:0,value:"1 video"}],ONE_PHOTO_AND_ONE_VIDEO:[{type:0,value:"1 photo and 1 video"}],ONE_PHOTO_AND_ONE_VIDEO_AMP:[{type:0,value:"1 photo & 1 video"}],MULTIPLE_PHOTOS_AND_ONE_VIDEO:[{type:1,value:"photos"},{type:0,value:" photos and 1 video"}],MULTIPLE_PHOTOS_AND_ONE_VIDEO_AMP:[{type:1,value:"photos"},{type:0,value:" photos & 1 video"}],MULTIPLE_VIDEOS:[{type:1,value:"videos"},{type:0,value:" videos"}],ONE_PHOTO_AND_MULTIPLE_VIDEOS:[{type:0,value:"1 photo and "},{type:1,value:"videos"},{type:0,value:" videos"}],ONE_PHOTO_AND_MULTIPLE_VIDEOS_AMP:[{type:0,value:"1 photo & "},{type:1,value:"videos"},{type:0,value:" videos"}],MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS:[{type:1,value:"photos"},{type:0,value:" photos and "},{type:1,value:"videos"},{type:0,value:" videos"}],MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS_AMP:[{type:1,value:"photos"},{type:0,value:" photos & "},{type:1,value:"videos"},{type:0,value:" videos"}],PHOTO_LIST:[{type:0,value:"Photo list"}],EXPLORE_TITLE:[{type:0,value:"Explore "},{type:3,value:"date",style:"long"}],BAD_DATE_TYPE:[{type:0,value:"Bad date type"}],ZERO_ITEMS:[{type:0,value:"0 items"}],ONE_ITEM:[{type:0,value:"1 item"}],MULTIPLE_ITEMS:[{type:1,value:"items"},{type:0,value:" items"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("flickr-photos-getHtmlMeta-fetcher",(function(e,t){"use strict";e.namespace("ModelFetchers")["flickr-photos-getHtmlMeta"]={run:function(o,r){var s={photo_id:o.id},a=this;return e.Promise.all([r.callAPI("flickr.photos.getHtmlMeta",s),r.getModelRegistry("photo-head-meta-models")]).then((function(e){return a._processResponse(e,o)}),e.FetcherErrorLogger(t))},_processResponse:function(t,o){var r,s=t[0],a=t[1];s&&s.HTMLMETA&&(r=e.APIHelper.response.parsePhotoMeta(s),a.addOrUpdate(r))}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-head-meta-models"]});YUI.add("photo-head-meta-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getHtmlMeta"].run(e,this.appContext)}},getFieldsForDisplay:function(t){var e={},r=this;return["title","noindexfollow","keywords","og:title","og:description","og:type","og:url","og:image","og:image:width","og:image:height","flickr_photos:by","flickr_photos:camera","flickr_photos:sets","flickr_photos:groups","flickr_photos:galleries","twitter:card","twitter:player","twitter:player:width","twitter:player:height","twitter:image","twitter:description","twitter:app:url:iphone","twitter:app:url:ipad","twitter:app:url:googleplay","twitter:creator","pinterest"].forEach((function(i){var o=r.getValue(t,i);void 0!==o&&(e[i]=o)})),e},attributes:{"og:title":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},noindexfollow:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},keywords:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},title:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:type":{},"og:url":{},"og:image":{},"og:image:width":{},"og:image:height":{},"flickr_photos:by":{},"flickr_photos:camera":{},"flickr_photos:sets":{},"flickr_photos:groups":{},"flickr_photos:galleries":{},"twitter:card":{},"twitter:player":{},"twitter:player:width":{},"twitter:player:height":{},"twitter:image":{},"twitter:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"twitter:app:url:iphone":{},"twitter:app:url:ipad":{},"twitter:app:url:googleplay":{},"twitter:creator":{},pinterest:{setter:function(t){return t}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getHtmlMeta-fetcher","flickr-photos-getInfo-fetcher","attribute-helpers"]});YUI.add("photo-notes-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},attributes:{notes:{isCollection:!0}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher"]});YUI.add("flickr-photos-addNotes-creator",(function(o,t){"use strict";o.namespace("ModelCreators")["flickr-photos-addNotes"]={run:function(e,r){var n=this;return o.Promise.all([r.callAPI("flickr.photos.notes.add",this._processParams(e)),r.getModelRegistry("photo-notes-models"),r.getModelRegistry("note-models")]).then((function(o){return n._processResponse(o,e)}),o.FetcherErrorLogger(t))},_processParams:function(o){return{photo_id:o.photoId,note_x:o.left,note_y:o.top,note_w:o.width,note_h:o.height,note_text:o.text}},_processResponse:function(o,t){var e,r=o[0],n=o[1],s=o[2];return s.addOrUpdate({id:r.note.id,left:r.note.x,top:r.note.y,width:r.note.w,height:r.note.h,text:r.note.content,author:r.note.author,authorName:r.note.authorname,authorRealName:r.note.authorrealname,authorIsPro:r.note.authorispro,authorProBadge:r.note.authorProBadge,authorIsDeleted:r.note.authorisdeleted}),e=s.proxy(r.note.id),n.exists(t.photoId)?n.getValue(t.photoId,"notes").appendToList(e):n.add({id:t.photoId,notes:[e]}),e}}}),"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});YUI.add("flickr-photos-editNote-updater",(function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-photos-editNote"]={run:function(o,n){var s=this;return e.Promise.all([n.callAPI("flickr.photos.notes.edit",this._processParams(o)),n.getModelRegistry("photo-notes-models"),n.getModelRegistry("note-models")]).then((function(e){return s._processResponse(e,o)}),e.FetcherErrorLogger(t))},_processParams:function(e){return{note_id:e.noteId,note_x:e.noteX,note_y:e.noteY,note_w:e.noteW,note_h:e.noteH,note_text:e.noteText}},_processResponse:function(e,t){var o,n=e[0],s=e[1];return(o=e[2].proxy(n.note.id)).setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),s.getValue(n.note.photoId,"notes").getFromListByID(n.note.id).setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),o}}}),"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});YUI.add("flickr-photos-deleteNote-deletor",(function(e,o){"use strict";e.namespace("ModelDeletors")["flickr-photos-deleteNote"]={run:function(t,r){var l={note_id:t};return r.callAPI("flickr.photos.notes.delete",l).then(null,e.FetcherErrorLogger(o))}}}),"@VERSION@",{requires:["flickr-promise"],optional:[]});